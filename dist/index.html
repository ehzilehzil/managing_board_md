<!DOCTYPE html><html lang="ko"> <head><meta charset="utf-8"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="viewport" content="width=device-width"><meta name="generator" content="Astro v5.16.3"><script src="https://cdn.jsdelivr.net/npm/jspreadsheet-ce@4/dist/index.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jspreadsheet-ce@4/dist/jspreadsheet.min.css" type="text/css"><script src="https://cdn.jsdelivr.net/npm/jsuites/dist/jsuites.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jsuites/dist/jsuites.min.css" type="text/css"><title>Managing Board</title><link rel="stylesheet" href="/managing_board_md/_astro/index.X4MiNoRO.css"><script type="module" src="/managing_board_md/_astro/page.7UCKLhDU.js"></script></head> <body>  <div class="fixed top-0 right-0 bottom-0 left-0 z-999"> <div class="h-full w-full flex flex-col"> <div class="flex-[0_0_0] m-[4px]"> <div>"사번"/"이름"/"비밀번호"를 정확히 기입하고, "비밀번호변경" 또는 "불러오기" 클릭을 해야 정상 작동합니다. 초기 비밀번호는 사번입니다.</div> <div x-data class="flex whitespace-nowrap items-center gap-x-[8px]"> <div> <label>사번:</label> <input type="text" id="no" x-model="$store.global.no"> </div> <div> <label>이름:</label> <input type="text" id="name" x-model="$store.global.name"> </div> <div> <label>비밀번호:</label> <input type="text" id="pw" x-model="$store.global.pw"> </div> </div> <script type="module">document.addEventListener("alpine:initialized",async()=>{alert('"사번"/"이름"/"비밀번호"를 입력한 뒤 시작하세요')});</script> </div> <hr> <div class="flex-[0_0_0] m-[4px]"> <div>비밀번호를 변경하고 싶다면, 위에 "사번"/"이름"/현재의 "비밀번호"를 기입한 뒤, 원하는 비밀번호를 넣고 "비밀번호 변경하기"를 클릭하세요. 비밀번호를 잊어버렸다면 관리자에게 문의하시기 바랍니다.</div> <div x-data class="flex whitespace-nowrap items-center gap-x-[8px]"> <div> <label>원하는 비밀번호:</label> <input type="text" id="no" x-model="$store.global.tobepw"> </div> <div> <button @click="$store.functions.changePW();">비밀번호 변경하기</button> </div> </div> <script type="module">document.addEventListener("alpine:initialized",async()=>{Alpine.store("functions").changePW=async()=>{console.log("changePW 호출");const t=Alpine.store("global").no.trim(),n=Alpine.store("global").name.trim(),o=Alpine.store("global").pw.trim();if(t===""||n===""||o===""){alert("사번/이름/비밀번호 모두 입력하세요.");return}const e=Alpine.store("global").tobepw.trim();if(e===void 0||e.trim().length===""||!/^[A-Za-z0-9]+$/.test(e)){alert("원하는 비밀번호가 올바른 형식이 아닙니다. 알파벳과 숫자만 사용하세요.");return}Alpine.store("tags").loading.style.display="flex";const l=await(await fetch(Alpine.store("global").url,{method:"POST",body:JSON.stringify({action:"changePW",no:t,name:n,pw:o,tobepw:e})})).json();Alpine.store("tags").loading.style.display="none",alert(l.message),l.status==="ok"&&(Alpine.store("global").tobepw="")}});</script> </div> <hr> <div class="flex-[1_0_0] m-[4px]"> <div class="w-full h-full flex flex-col"> <div>"불러오기" 클릭해서, 담당하시는 거래처를 불러오시기 바랍니다. 상태를 수정한 뒤, 반드시 "업데이트"를 클릭해야 거래처 상태가 수정반영됩니다.</div> <div x-data> <button @click="$store.functions.getStatus();">불러오기</button> <button @click="$store.functions.updateStatus();">업데이트</button> </div> <div class="flex-[1_0_0] overflow-auto m-[4px]"> <div class="h-full w-full"> <div id="jspreadsheet"></div> </div> </div> </div> <script type="module">document.addEventListener("alpine:initialized",async()=>{Alpine.store("functions").getStatus=async()=>{console.log("getStatus 호출");const m=Alpine.store("global").no.trim(),i=Alpine.store("global").name.trim(),c=Alpine.store("global").pw.trim();if(m===""||i===""||c===""){alert("사번/이름/비밀번호 모두 입력하세요.");return}Alpine.store("tags").loading.style.display="flex";const a=await(await fetch(Alpine.store("global").url,{method:"POST",body:JSON.stringify({action:"getStatus",no:m,name:i,pw:c})})).json();if(Alpine.store("tags").loading.style.display="none",alert(a.message),a.status!=="ok")return;const o=Alpine.store("tags").jspreadsheet;o.innerHTML="";const d=document.createElement("table"),u=document.createElement("thead"),r=document.createElement("tbody");a.data.forEach((l,t,e)=>{if(t!==0)if(t===1){const n=document.createElement("tr");l.forEach(p=>{const h=document.createElement("th");h.textContent=p,n.appendChild(h)}),u.appendChild(n),d.appendChild(u)}else{const n=document.createElement("tr");l.forEach((p,h)=>{const s=document.createElement("td");switch(e[0][h]){case"checkbox":const g=document.createElement("input");g.type="checkbox",g.checked=p==="O",g.style.cursor="pointer",s.appendChild(g),s.style.cursor="pointer",s.style.textAlign="center",s.addEventListener("click",b=>{if(b.target.tagName.toLowerCase()==="input")return;const f=s.querySelector("input[type='checkbox']");f&&(f.checked=!f.checked)});break;case"text":s.textContent=p,s.className="editable",s.style.cursor="pointer";break;default:s.textContent=p}n.appendChild(s)}),r.appendChild(n)}}),d.appendChild(r),o.appendChild(d),d.addEventListener("click",l=>{const t=l.target.closest("td.editable");if(!t||t.querySelector("textarea.editor"))return;const e=document.createElement("textarea");e.className="editor",e.value=t.textContent,t.textContent="",t.appendChild(e),e.focus(),e.addEventListener("blur",()=>{t.textContent=e.value}),e.addEventListener("input",()=>{e.style.height="auto",e.style.height=e.scrollHeight+"px",t.style.height=e.style.height}),e.addEventListener("keydown",n=>{if(n.key==="Enter"){if(n.shiftKey||n.altKey)return;n.preventDefault(),e.blur()}})})},Alpine.store("functions").updateStatus=async()=>{if(console.log("updateStatus 호출"),Alpine.store("tags").jspreadsheet.innerHTML===""){alert("불러오기를 먼저 실행해주세요.");return}const i=Alpine.store("global").no.trim(),c=Alpine.store("global").name.trim(),y=Alpine.store("global").pw.trim();if(i===""||c===""||y===""){alert("사번/이름/비밀번호 모두 입력하세요.");return}let a=[];const o=document.querySelectorAll("tr");if(o.length<2){alert("업데이트 할 내용이 없습니다.");return}for(let r=1;r<o.length;r++){const l=o[r].querySelectorAll("td");let t=[];for(let e=0;e<l.length;e++)l[e].firstChild?.tagName?.toLowerCase()==="input"?t.push(l[e].firstChild.checked?"O":"X"):t.push(l[e].textContent);a.push(t)}Alpine.store("tags").loading.style.display="flex";const u=await(await fetch(Alpine.store("global").url,{method:"POST",body:JSON.stringify({action:"updateStatus",no:i,name:c,pw:y,data:a})})).json();Alpine.store("tags").loading.style.display="none",alert(u.message)}});</script> </div> </div> </div> <div id="loading" style="display:none;" class="fixed top-0 right-0 bottom-0 left-0 z-9999 bg-gray-300 opacity-80 items-center justify-center"> <div class="w-12 h-12 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"></div> </div>  </body></html> <script type="module">document.addEventListener("alpine:init",()=>{Alpine.store("tags",{loading:document.querySelector("#loading"),jspreadsheet:document.querySelector("#jspreadsheet")}),Alpine.store("global",{no:"",name:"",pw:"",tobepw:"",data:[],url:"https://script.google.com/macros/s/AKfycbzRq_pMAWi5gJkSVLEYBcPGuLfRHwdmKnrp278IAocT0DuJKY5GasjKRcrqiomNke6W/exec"}),Alpine.store("functions",{changePW:()=>{},getStatus:()=>{},updateStatus:()=>{}})});</script>