<!DOCTYPE html><html lang="ko"> <head><meta charset="utf-8"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="viewport" content="width=device-width"><meta name="generator" content="Astro v5.16.3"><script src="https://cdn.jsdelivr.net/npm/jspreadsheet-ce@4/dist/index.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jspreadsheet-ce@4/dist/jspreadsheet.min.css" type="text/css"><script src="https://cdn.jsdelivr.net/npm/jsuites/dist/jsuites.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jsuites/dist/jsuites.min.css" type="text/css"><title>Astro</title><link rel="stylesheet" href="/managing_board/_astro/index.uOZImDUg.css"><script type="module" src="/managing_board/_astro/page.7UCKLhDU.js"></script></head> <body>  <div class="fixed top-0 right-0 bottom-0 left-0 z-999"> <div class="h-full w-full flex flex-col"> <div class="flex-[0_0_0] m-[4px]"> <div>"사번"/"이름"/"비밀번호"를 정확히 기입한 뒤, "비밀번호변경" 또는 "불러오기" 클릭이 정상 작동합니다. 초기 비밀번호는 사번입니다.</div> <div x-data class="flex whitespace-nowrap items-center gap-x-[8px]"> <div> <label>사번:</label> <input type="text" id="no" x-model="$store.global.no"> </div> <div> <label>이름:</label> <input type="text" id="name" x-model="$store.global.name"> </div> <div> <label>비밀번호:</label> <input type="text" id="pw" x-model="$store.global.pw"> </div> </div> <script type="module">document.addEventListener("alpine:initialized",async()=>{alert('"사번"/"이름"/"비밀번호"를 입력한 뒤 시작하세요')});</script> </div> <hr> <div class="flex-[0_0_0] m-[4px]"> <div>비밀번호를 변경하고 싶다면, 위에 "사번"/"이름"/현재의 "비밀번호"를 기입한 뒤, 원하는 비밀번호를 넣고 "비밀번호 변경하기"를 클릭하세요. 비밀번호를 잊어버렸다면 관리자에게 문의하시기 바랍니다.</div> <div x-data class="flex whitespace-nowrap items-center gap-x-[8px]"> <div> <label>원하는 비밀번호:</label> <input type="text" id="no" x-model="$store.global.tobepw"> </div> <div> <button @click="$store.functions.changePW();">비밀번호 변경하기</button> </div> </div> <script type="module">document.addEventListener("alpine:initialized",async()=>{Alpine.store("functions").changePW=async()=>{console.log("changePW 호출");const t=Alpine.store("global").no.trim(),n=Alpine.store("global").name.trim(),o=Alpine.store("global").pw.trim();if(t===""||n===""||o===""){alert("사번/이름/비밀번호 모두 입력하세요.");return}const e=Alpine.store("global").tobepw.trim();if(e===void 0||e.trim().length===""||!/^[A-Za-z0-9]+$/.test(e)){alert("원하는 비밀번호가 올바른 형식이 아닙니다. 알파벳과 숫자만 사용하세요.");return}Alpine.store("tags").loading.style.display="flex";const l=await(await fetch(Alpine.store("global").url,{method:"POST",body:JSON.stringify({action:"changePW",no:t,name:n,pw:o,tobepw:e})})).json();Alpine.store("tags").loading.style.display="none",alert(l.message),l.status==="ok"&&(Alpine.store("global").tobepw="")}});</script> </div> <hr> <div class="flex-[1_0_0] m-[4px]"> <div class="w-full h-full flex flex-col"> <div>"불러오기" 클릭해서, 담당하시는 거래처를 불러오시기 바랍니다. 상태를 수정한 뒤, 반드시 "업데이트"를 클릭해야 거래처 상태가 수정반영됩니다.</div> <div x-data> <button @click="$store.functions.getStatus();">불러오기</button> <button @click="$store.functions.updateStatus();">업데이트</button> </div> <div class="flex-[1_0_0] overflow-auto m-[4px]"> <div class="h-full w-full"> <div id="jspreadsheet"></div> </div> </div> </div> <script type="module">document.addEventListener("alpine:initialized",async()=>{Alpine.store("functions").getStatus=async()=>{console.log("getStatus 호출");const u=Alpine.store("global").no.trim(),l=Alpine.store("global").name.trim(),a=Alpine.store("global").pw.trim();if(u===""||l===""||a===""){alert("사번/이름/비밀번호 모두 입력하세요.");return}Alpine.store("tags").loading.style.display="flex";const n=await(await fetch(Alpine.store("global").url,{method:"POST",body:JSON.stringify({action:"getStatus",no:u,name:l,pw:a})})).json();if(Alpine.store("tags").loading.style.display="none",alert(n.message),n.status!=="ok")return;const o=Alpine.store("tags").jspreadsheet;o.innerHTML="";const r=document.createElement("table"),i=document.createElement("thead"),s=document.createElement("tbody");n.data.forEach((t,c)=>{if(c===0){const e=document.createElement("tr");t.forEach(d=>{const p=document.createElement("th");p.textContent=d,e.appendChild(p)}),i.appendChild(e),r.appendChild(i)}else{const e=document.createElement("tr");t.forEach((d,p)=>{const g=document.createElement("td");if(p<4)g.textContent=d;else{const h=document.createElement("input");h.type="checkbox",h.checked=d==="O",g.appendChild(h)}e.appendChild(g)}),s.appendChild(e)}}),r.appendChild(s),o.appendChild(r)},Alpine.store("functions").updateStatus=async()=>{if(console.log("updateStatus 호출"),Alpine.store("tags").jspreadsheet.innerHTML===""){alert("불러오기를 먼저 실행해주세요.");return}const l=Alpine.store("global").no.trim(),a=Alpine.store("global").name.trim(),m=Alpine.store("global").pw.trim();if(l===""||a===""||m===""){alert("사번/이름/비밀번호 모두 입력하세요.");return}let n=[];const o=document.querySelectorAll("tr");if(o.length<2){alert("업데이트 할 내용이 없습니다.");return}for(let s=1;s<o.length;s++){const t=o[s].querySelectorAll("td");let c=[t[0].textContent,t[1].textContent,t[2].textContent,t[3].textContent];for(let e=4;e<t.length;e++)c.push(t[e].firstChild.checked?"O":"X");n.push(c)}Alpine.store("tags").loading.style.display="flex";const i=await(await fetch(Alpine.store("global").url,{method:"POST",body:JSON.stringify({action:"updateStatus",no:l,name:a,pw:m,data:n})})).json();Alpine.store("tags").loading.style.display="none",alert(i.message)}});</script> </div> </div> </div> <div id="loading" style="display:none;" class="fixed top-0 right-0 bottom-0 left-0 z-9999 bg-gray-300 opacity-80 items-center justify-center"> <div class="w-12 h-12 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"></div> </div>  </body></html> <script type="module">document.addEventListener("alpine:init",()=>{Alpine.store("tags",{loading:document.querySelector("#loading"),jspreadsheet:document.querySelector("#jspreadsheet")}),Alpine.store("global",{no:"",name:"",pw:"",tobepw:"",data:[],url:"https://script.google.com/macros/s/AKfycbyZjVF9ZDlV7pZd5ZyQKYWZ5ZhSAjVwwBToYfzdo5zGcopjTq7_q4zmZlsGXyAoyjML_Q/exec"}),Alpine.store("functions",{changePW:()=>{},getStatus:()=>{},updateStatus:()=>{}})});</script>